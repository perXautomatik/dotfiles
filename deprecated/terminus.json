{
    "extract_dir": "terminus-ttf-4.47.0-windows",
    "post_install": [
        "add-type -name func -namespace \"\" -member @\"",
        "[DllImport(\"user32.dll\")]",
        "public static extern bool PostMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);",
        "",
        "[DllImport(\"user32.dll\")]",
        "public static extern int SendMessage(IntPtr hWnd, int wMsg, IntPtr wParam, IntPtr lParam);",
        "",
        "[DllImport(\"gdi32.dll\")]",
        "public static extern int AddFontResource(string filePath);",
        "",
        "[DllImport(\"gdi32.dll\")]",
        "public static extern int RemoveFontResource(string lpFileName);",
        "\"@",
        "",
        "$objfontFolder = (New-Object -ComObject Shell.Application).Namespace(0x14).self.Path",
        "",
        "dir (Join-Path -Path $dir -ChildPath \"*.ttf\") | %{",
        "    if(Test-Path (Join-Path -Path $objfontFolder -ChildPath $_.Name)) {",
        "        Write-Host \"Font {$($_.Name)} already exists in {$objfontFolder}\"",
        "    }",
        "    else {",
        "        Copy-Item -Path $_.fullname -Destination (Join-Path -Path $objfontFolder -ChildPath $_.Name)",
        "        Write-Host \"Installing Font {$($_.Name)} in {$objfontFolder}\"",
        "",
        "        $ret = [func]::AddFontResource((Join-Path -Path $objfontFolder -ChildPath $_.Name))",
        "",
        "        Add-Type -AssemblyName System.Drawing",
        "        $objFontCollection = New-Object System.Drawing.Text.PrivateFontCollection",
        "        $objFontCollection.AddFontFile($_.FullName)",
        "        $FontName = $objFontCollection.Families.Name",
        "",
        "        $fontRegistryPath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\"",
        "        $regTest = Get-ItemProperty -Path $fontRegistryPath -Name \"*$FontName*\" -ErrorAction SilentlyContinue",
        "        if (-not ($regTest)) {",
        "          $prop = New-ItemProperty -Name $FontName -Path $fontRegistryPath -PropertyType string -Value $_.Name",
        "          Write-Host \"Registering font {$($_.Name)} in registry with name {$FontName}\"",
        "        }",
        "    }",
        "}",
        "",
        "$ret = [func]::PostMessage(0xFFFF, 0x001D, 0, 0)"
    ],
    "uninstaller": {
        "script": [
            "add-type -name func -namespace \"\" -member @\"",
            "[DllImport(\"user32.dll\")]",
            "public static extern bool PostMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);",
            "",
            "[DllImport(\"user32.dll\")]",
            "public static extern int SendMessage(IntPtr hWnd, int wMsg, IntPtr wParam, IntPtr lParam);",
            "",
            "[DllImport(\"gdi32.dll\")]",
            "public static extern int AddFontResource(string filePath);",
            "",
            "[DllImport(\"gdi32.dll\")]",
            "public static extern int RemoveFontResource(string lpFileName);",
            "\"@",
            "",
            "$objfontFolder = (New-Object -ComObject Shell.Application).Namespace(0x14).self.Path",
            "",
            "dir (Join-Path -Path $dir -ChildPath \"*.ttf\") | %{",
            "    if(Test-Path (Join-Path -Path $objfontFolder -ChildPath $_.Name)) {",
            "        Write-Host \"Removing Font {$($_.Name)} in {$objfontFolder}\"",
            "        $ret = [func]::RemoveFontResource((Join-Path -Path $objfontFolder -ChildPath $_.Name))",
            "        Remove-Item -Path (Join-Path -Path $objfontFolder -ChildPath $_.Name)",
            "    }",
            "",
            "    Add-Type -AssemblyName System.Drawing",
            "    $objFontCollection = New-Object System.Drawing.Text.PrivateFontCollection",
            "    $objFontCollection.AddFontFile($_.FullName)",
            "    $FontName = $objFontCollection.Families.Name",
            "",
            "    $fontRegistryPath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\"",
            "    $regTest = Get-ItemProperty -Path $fontRegistryPath -Name \"*$FontName*\" -ErrorAction SilentlyContinue",
            "    if ($regTest) {",
            "      Remove-ItemProperty -Name $FontName -Path $fontRegistryPath",
            "      Write-Host \"Removing font {$($_.Name)} in registry with name {$FontName}\"",
            "    }",
            "}",
            "",
            "$ret = [func]::PostMessage(0xFFFF, 0x001D, 0, 0)"
        ]
    },
    "url": "https://files.ax86.net/terminus-ttf/files/latest/terminus-ttf-4.47.0-windows.zip",
    "hash": "959efd0fbe2bbb42b64724bab54a6b42c0c7053ff65566e4c57df5e9f9189e39",
    "version": "4.47.0"
}
