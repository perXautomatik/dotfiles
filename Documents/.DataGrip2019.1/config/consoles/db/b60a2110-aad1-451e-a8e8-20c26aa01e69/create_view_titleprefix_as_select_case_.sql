CREATE VIEW TitlePrefix as
select case
           when url like '%sql%' OR xz like '%sql%' then 'sql - ' || xz when url like 'https://stackoverflow%' OR url like '%stackexchange%' then 'stackOverflow - ' || xz when xz like '%AlternativeTo.net' then 'AlternativeTo.net - ' || xz when xz like '%Chrome Web Store' then 'Chrome Web Store - ' || xz when xz like '%Google Search' then 'googleSearch - ' || xz when xz like '%Wikipedia' then 'Wikipedia - ' || xz when xz like '%YouTube' then 'YouTube - ' || xz when xz like '%Discogs' then 'Discogs - ' || xz when xz like '%Office Support' then 'Office Support - ' || xz when xz like '%pdf%' then 'pdf - ' || xz when xz like '%spotify%' then 'spotify - ' || xz when url like '%bandcamp%' then '1bandcamp - ' || xz else xz end yz,
       *
from (select sum(urls.visit_count) / count(url) c,
             count(url)                         UniqeUrls,
             max(url)                           url,
             case when url like 'https://developer.spotify.com/community/%' then 'spotify community news' when url like 'https://github.com/jack-guy%' then 'github.com/jack-guy' when url like 'https://www.portablefreeware%' then 'portablefreeware' when url like 'https://cpu.userbenchmark.com%' then 'userbenchmark' when url like 'https://www.techrepublic.com%' then 'techrepublic' when url like 'https://accounts.google.com/%' then 'google auth' when url like '%https://www.freeformatter%' then 'freeformatter' when url like 'https://play.google.com/music%' then 'playMusic' when url like 'https://www.systembolaget%' then 'systembolaget' when url like 'https://www.pathofexile.com/trade/' then 'trade' when url like 'https://www.tunemymusic.com%' then 'tuneMyMusic' when url like 'https://www.roligaprylar%' then 'RoligaPrylar' when url like '%playlistmachinery%' then 'playlistMachinery' when url like 'https://www.mtggoldfish%' then 'mtggoldfish' when url like 'https://web.archive.org%' then 'web.archive' when url like 'https://jmperezperez.%' then 'jmperezperez' when url like 'https://help.github.com%' then 'helpGithub' when url like 'https://www.blockscad3d%' then 'blockScad' when url like 'https://www.facebook.com%' then 'facebook' when url like 'https://www.linkedin.com%' then 'LinkedIn' when url like 'https://textmechanic%' then 'textmechanic' when url like 'https://www.teamviewer%' then 'teamviewer' when url like 'https://www.rescuetime%' then 'rescuetime' when url like 'chrome-extension%' then 'chromeExtension' when url like 'https://www.multcloud%' then 'multicloud' when url like 'https://photos.google.com%' then 'photos' when url like 'https://www.netflix.com%' then 'netflix' when url like 'https://drive.google.com%' then 'drive' when url like 'https://docs.google.com%' then 'sheets' when url like 'https://mail.google.com%' then 'Gmail' when url like 'https://www.office.com%' then 'office' when url like 'https://descent.live%' then 'descent' when url like 'http://everynoise%' then 'everynoise' when url like 'https://www.youtube.%' then 'youtube' when url like 'https://en.bab.la%' then 'en.bab.la' when url like 'https://svs-games%' then 'svs-games' when url like 'https://brancher.%' then 'brancher' when url like 'https://lastpass.%' then 'lastpass' when url like 'https://poe.ninja%' then 'poeNinja' when url like '%recovery%' then 'accountRecovery' when url like 'https://dubolt.com%' then 'dubolt' when url like 'https://trello.com%' then 'trello' when url like 'https://zapier.com%' then 'Zapier' when url like 'https://atom.io/%' then 'atom.io' when url like 'https://gist.github%' then 'gist' when url like 'https://ifttt.com/%' then 'ifttt' when url like 'https://getpocket%' then 'pocket' when url like '%redirection%' then 'redirection' when url like 'https://todoist.com%' then 'todo' when url like 'https://crm.zoho.eu%' then 'zoho' when url like 'https://www.diigo%' then 'diigo' when url like 'https://www.figma%' then 'figma' when url like 'https://www.pdf2go%' then 'pdf' when url like '%wunderlist%' then 'wunderlist' when url like '%filmtipset%' then 'filmtipset' when url like '%google%/maps%' then 'maps' when url like '%enquoted%' then 'enquoted' when url like '%mapinfo%' then 'mapinfo' when url like '%onenote%' then 'oneNote' when url like '%shikaka%' then 'shikaka' when url like 'https://ssk_%' then 'ssk' when url like 'https://service.gotland.se%' or url like 'https://www.gotland.se%' or url like 'https://gis.gotland.se%' or url like 'https://zero.comaround.com%' or url like 'https://adfs.gotland.se/%' or url like 'https://login.comaround%' or url like 'https://filr.gotland.se%' or url like 'https://gotlandskommun-my.sharepoint%' or url like 'https://ua.gotland.se%' or url like 'https://mvprod.gotland.se%' or url like '%portalen%gotland.se%' then 'portalen' when url like 'http://192.168.2.254%' or url like 'https://www.google%/pagead%' or url like 'file:%' or url like 'https://login.microsoftonline%' or url like 'https://login.live.%' or url like 'https://europe-001.consent.azure%' or url like '%mirox23.biz%' or url like '%adaranth%' then '192.168.2.254' when url like 'https://github.com/perXautomatik%' or url like 'https://github.com/desktop%' or url like 'https://github.com/settings%' then 'github' when url like 'https://open.spotify.com%' or url like 'https://accounts.spotify.com%' or url like 'https://www.spotify%' then 'spotify' when url like '%flow.microsoft%' or url like 'https://make.powerapps%' then 'flow' when url like '%github.com/v3/oauth%' or url like 'https://auth0.com%' then 'GitAuth' when url like 'https://onedrive%' or url like '%skydrive.live.com%' then 'oneDrive' when url like 'https://messages.google.com%' or url like 'https://www.messenger.com/%' then 'Messenger' when url like 'https://www.last.fm/user/konstruktor_k%' or url like '%www.last.fm%' then 'last.fm' when title in ('', ' and Advice for Technology Professionals - TechRepublic', 'reddit: the front page of the internet', 'Sign in â€“ Google accounts', 'Sign in to your account', 'Search | Last.fm', 'portablefreeware', 'Redirect Notice', 'News, Tips,', 'Working...', 'Continue', 'Verified', 'Google', 'Coova') then url else title end                 xz from urls

      group by xz) z
where substr(yz,1) <> substr(xz,1)
order by xz
limit 500;

